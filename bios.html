<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FORJAX BIOS - TRADER DECK</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

        /* RESET & BASICS */
        body {
            background-color: #000;
            color: #0f0;
            font-family: 'Share Tech Mono', monospace;
            overflow: hidden;
            height: 100dvh;
            display: flex;
            flex-direction: column;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* CRT EFFECTS */
        .scanlines {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 3px, 3px 100%;
            animation: flicker 0.15s infinite;
        }
        @keyframes flicker { 0% { opacity: 0.9; } 50% { opacity: 1.0; } 100% { opacity: 0.9; } }

        /* TERMINAL AREA */
        #terminal {
            flex: 1;
            padding: 1rem;
            overflow-y: hidden; /* Evitamos scroll manual, todo fijo */
            display: flex;
            flex-direction: column;
            font-size: 13px;
            text-shadow: 0 0 5px #0f0;
            position: relative;
        }

        /* SECCIONES DEL LAYOUT */
        .header-log { height: 35%; overflow-y: auto; border-bottom: 1px solid #004400; padding-bottom: 10px; margin-bottom: 10px; }
        .bio-deck { height: 65%; display: flex; flex-direction: column; gap: 5px; opacity: 0; transition: opacity 1s; }
        
        /* TEXT STYLES */
        .sys-ok { color: #0f0; }
        .sys-warn { color: #ffff00; }
        .sys-crit { color: #ff003c; font-weight: bold; text-shadow: 0 0 10px #ff003c; }
        .sys-dim { color: #005500; }
        .glitch { animation: glitch 1s linear infinite; }
        @keyframes glitch { 2%, 64% { transform: translate(2px,0) skew(0deg); } 4%, 60% { transform: translate(-2px,0) skew(0deg); } 62% { transform: translate(0,0) skew(5deg); } }

        /* BIO METRICS GRID */
        .metric-row { display: flex; justify-content: space-between; align-items: center; border: 1px solid #003300; padding: 8px; background: #001100; }
        .metric-label { font-size: 10px; color: #008800; letter-spacing: 1px; }
        .metric-val { font-size: 24px; font-weight: bold; }
        .ecg-line { height: 30px; width: 100%; display: flex; align-items: flex-end; gap: 2px; overflow: hidden; margin-top: 5px; opacity: 0.7; }
        .ecg-bar { width: 4px; background: #0f0; transition: height 0.1s; }

        /* CONTROLS */
        #controls {
            height: 70px;
            border-top: 2px solid #005500;
            background: #050b14;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1px;
            z-index: 20;
        }
        .btn-bio {
            background: #001100; color: #005500; border: none;
            font-family: 'Share Tech Mono', monospace; font-size: 1rem; font-weight: bold;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .btn-bio:active { background: #0f0; color: #000; }
        .panic-active { background: #ff003c !important; color: #fff !important; animation: pulseRed 0.5s infinite; }
        @keyframes pulseRed { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

        /* SHUTDOWN */
        .shutdown { animation: turn-off 0.55s cubic-bezier(0.23, 1, 0.32, 1) forwards; }
        @keyframes turn-off {
            0% { transform: scale(1, 1.3); filter: brightness(1); opacity: 1; }
            100% { transform: scale(0, 0); filter: brightness(50); opacity: 0; }
        }
    </style>
</head>
<body>

    <div class="scanlines"></div>
    
    <div id="terminal">
        <div id="bootLog" class="header-log"></div>

        <div id="bioDeck" class="bio-deck">
            <div class="flex justify-between border-b border-[#004400] pb-1">
                <span class="text-xs text-[#008800]">DEVICE: WATCH_ULTRA_2</span>
                <span class="text-xs text-[#008800] blink">● LINKED</span>
            </div>

            <div class="metric-row">
                <div>
                    <div class="metric-label">HEART RATE (BPM)</div>
                    <div id="bpmVal" class="metric-val text-emerald-400">--</div>
                </div>
                <div class="text-right">
                    <div class="metric-label">ZONE</div>
                    <div id="bpmZone" class="text-xs font-bold text-white">CALIBRATING</div>
                </div>
            </div>
            <div id="ecgGraph" class="ecg-line"></div>

            <div class="metric-row">
                <div>
                    <div class="metric-label">CORTISOL LVL</div>
                    <div id="stressVal" class="metric-val text-yellow-400">--%</div>
                </div>
                <div>
                    <div class="metric-label">FOCUS STATE</div>
                    <div id="focusVal" class="metric-val text-cyan-400">--%</div>
                </div>
            </div>

            <div class="border border-[#003300] p-2 bg-[#000500] mt-auto">
                <div class="text-[10px] text-[#005500] mb-1">MARKET FEED (FOREX/CRYPTO)</div>
                <div id="marketTick" class="text-xs font-mono text-white truncate">WAITING FOR TICKER...</div>
            </div>
        </div>
    </div>

    <div id="controls">
        <button class="btn-bio" onclick="location.reload()"><span>[ R ]</span><span class="text-[8px]">REBOOT</span></button>
        <button class="btn-bio" id="btnPanic" onclick="cmdPanic()"><span>[ P ]</span><span class="text-[8px]">LOCK</span></button>
        <button class="btn-bio" onclick="cmdExit()"><span>[ ESC ]</span><span class="text-[8px]">EXIT</span></button>
    </div>

    <script>
        const log = document.getElementById('bootLog');
        const bioDeck = document.getElementById('bioDeck');
        const user = localStorage.getItem("currentUser") || "TRADER";
        
        const vibe = (ms) => { if(navigator.vibrate) navigator.vibrate(ms); };
        
        // --- 1. SISTEMA DE ARRANQUE ---
        const print = async (txt, color="sys-ok") => {
            const div = document.createElement('div');
            div.className = color;
            div.innerText = txt;
            log.appendChild(div);
            log.scrollTop = log.scrollHeight;
            await new Promise(r => setTimeout(r, 50)); // Muy rápido
        };

        const boot = async () => {
            vibe(20);
            await print("FORJAX BIOS V.50 [TRADER_EDITION]", "sys-dim");
            await print("> CPU: NEURAL ENGINE X1... OK", "sys-dim");
            await print("> MEM: 128TB CLOUD... OK", "sys-dim");
            await print("> CRYPTO WALLET... SYNCED", "sys-ok");
            await print("> SCANNING BLUETOOTH...", "sys-warn");
            
            await new Promise(r => setTimeout(r, 400)); // Pequeña pausa dramática
            await print("> DEVICE FOUND: [WATCH_ULTRA_2]", "sys-ok");
            await print("> ESTABLISHING BIO-LINK...", "blink");
            
            await new Promise(r => setTimeout(r, 600));
            await print("> CONNECTION ESTABLISHED.", "sys-ok");
            
            // Mostrar Panel Biométrico
            bioDeck.style.opacity = "1";
            startBioEngine();
            updatePanicVisuals();
        };

        // --- 2. MOTOR DE SIMULACIÓN BIOMÉTRICA ---
        let currentBPM = 72;
        let stress = 15;
        let focus = 88;
        
        function startBioEngine() {
            // Inicializar gráfico ECG
            const ecg = document.getElementById('ecgGraph');
            for(let i=0; i<40; i++) {
                const bar = document.createElement('div');
                bar.className = 'ecg-bar';
                bar.style.height = '2px';
                ecg.appendChild(bar);
            }

            // Loop principal (cada 1s)
            setInterval(() => {
                // Fluctuación random del corazón
                const volatility = Math.random();
                if(volatility > 0.7) currentBPM += Math.floor(Math.random() * 5); 
                else if(volatility < 0.3) currentBPM -= Math.floor(Math.random() * 4);
                
                // Limites humanos
                if(currentBPM < 55) currentBPM = 58;
                if(currentBPM > 160) currentBPM = 155;

                // Calculo de estrés
                stress = Math.floor((currentBPM - 60) * 1.2);
                if(stress < 5) stress = 5; if(stress > 99) stress = 99;

                // Calculo de Foco (Inverso al estrés, pero no lineal)
                focus = 100 - Math.floor(stress * 0.6) + Math.floor(Math.random() * 5);
                if(focus > 100) focus = 100;

                updateDOM();
            }, 800);

            // Loop visual rápido (ECG) cada 50ms
            setInterval(updateECG, 50);

            // Loop de Mercado Falso
            setInterval(updateMarketTicker, 1500);
        }

        function updateDOM() {
            document.getElementById('bpmVal').innerText = currentBPM;
            document.getElementById('stressVal').innerText = stress + "%";
            document.getElementById('focusVal').innerText = focus + "%";

            // Color del BPM
            const bpmEl = document.getElementById('bpmVal');
            const zoneEl = document.getElementById('bpmZone');
            
            if(currentBPM < 90) { 
                bpmEl.className = "metric-val text-emerald-400"; 
                zoneEl.innerText = "RESTING / CALM";
                zoneEl.className = "text-xs font-bold text-emerald-500";
            } else if(currentBPM < 120) { 
                bpmEl.className = "metric-val text-yellow-400"; 
                zoneEl.innerText = "AEROBIC / TRADING";
                zoneEl.className = "text-xs font-bold text-yellow-500";
            } else { 
                bpmEl.className = "metric-val text-rose-500 glitch"; 
                zoneEl.innerText = "!!! ADRENALINE !!!";
                zoneEl.className = "text-xs font-bold text-rose-500 blink";
                vibe(30); // Vibra si estás muy manija
            }
        }

        function updateECG() {
            const bars = document.querySelectorAll('.ecg-bar');
            // Mover alturas a la izquierda
            for(let i=0; i<bars.length-1; i++) {
                bars[i].style.height = bars[i+1].style.height;
                // Color map
                const h = parseInt(bars[i].style.height);
                bars[i].style.background = h > 20 ? '#ff003c' : '#0f0';
            }
            // Generar nueva barra a la derecha
            // Simulamos el pico QRS de un latido
            let newH = 2;
            const now = Date.now();
            // Simular latido basado en BPM
            const beatInterval = 60000 / currentBPM; 
            if (now % beatInterval < 100) {
                newH = Math.random() * 25 + 5; // Pico alto
            } else {
                newH = Math.random() * 4 + 2; // Ruido base
            }
            bars[bars.length-1].style.height = newH + 'px';
        }

        const tickers = ["BTC/USD 96,420 ▲", "ETH/USD 2,850 ▼", "EUR/USD 1.082 ▬", "XAU/USD 2,050 ▲", "NVDA 890.50 ▲", "TSLA 175.20 ▼"];
        function updateMarketTicker() {
            const t = tickers[Math.floor(Math.random() * tickers.length)];
            const el = document.getElementById('marketTick');
            el.innerText = `>> FEED: ${t} [VOL: ${(Math.random()*100).toFixed(2)}M]`;
            if(t.includes("▼")) el.className = "text-xs font-mono text-rose-400 truncate";
            else el.className = "text-xs font-mono text-emerald-400 truncate";
        }

        // --- 3. COMANDOS ---
        function updatePanicVisuals() {
            const isPanic = localStorage.getItem("forjax_panic_mode") === "true";
            const btn = document.getElementById("btnPanic");
            if(isPanic) {
                btn.classList.add("panic-active");
                print("> SYSTEM LOCKED.", "sys-crit");
            } else {
                btn.classList.remove("panic-active");
            }
        }

        function cmdPanic() {
            vibe(50);
            const current = localStorage.getItem("forjax_panic_mode") === "true";
            localStorage.setItem("forjax_panic_mode", !current);
            updatePanicVisuals();
        }

        function cmdExit() {
            vibe(30);
            document.body.classList.add("shutdown");
            setTimeout(() => window.location.href = "index.html", 400);
        }

        // START
        boot();

    </script>
</body>
</html>
